#include <bits/stdc++.h>
using namespace std;

typedef pair<int, int> ii;
typedef long long ll;


int main() {


   int cn;
   cin >> cn;
   while (cn--) {

      int n;
      cin >> n >> ws;

      vector<int> v[401];
      queue<int> q;
      
      for (int i = 0; i < n; i++) {
	 int pg;
	 cin >> pg >> ws;
	 char c = cin.peek();
	 if (isdigit(c)) {
	    int a, b, c;
	    cin >> a >> b >> c;
	    v[pg].push_back(a);
	    v[pg].push_back(b);
	    v[pg].push_back(c);
	 } else {
	    string s;
	    cin >> s;
	    if (s == "favourably") {
	       v[pg].push_back(0);
	    } else {
	       v[pg].push_back(-1);
	    }
	 }
      }


      q.push(1);      
      ll soln_count = 0;
      while (!q.empty()) {
	 
	 int curr = q.front();
	 q.pop();

	 if (curr == 0) {
	    soln_count++;
	    continue;
	 } else if (curr == -1) {
	    continue;
	 } else {
	    // add childs
	    for (int i = 0; i < v[curr].size(); i++) {
	       q.push(v[curr][i]);
	    }
	 }	 
	 
      }
      cout << soln_count << endl;
      
      


   }
   


   return 0;
}
